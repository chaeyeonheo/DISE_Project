# ğŸ¥ DISE ë¹„ë””ì˜¤ ë¶„ì„ í”„ë¡œì íŠ¸ ì™„ì „ ì •ë¦¬ (A to Z)

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

### ëª©ì 
ìˆ˜ë©´ ë¬´í˜¸í¡ì¦(OSA) í™˜ìì˜ **DISE(Drug-Induced Sleep Endoscopy)** ë¹„ë””ì˜¤ë¥¼ ìë™ìœ¼ë¡œ ë¶„ì„í•˜ì—¬:
1. **ì˜ì—­ ë¶„ë¥˜**: OTE/Velum/None êµ¬ë¶„
2. **íìƒ‰ íƒì§€**: ê¸°ë„ íìƒ‰ ì •ë„ ì¸¡ì •
3. **ë³´ê³ ì„œ ìƒì„±**: ì˜ë£Œì§„ì´ í™œìš© ê°€ëŠ¥í•œ ìë™ ë³´ê³ ì„œ

### ìµœì¢… ëª©í‘œ
```
ì…ë ¥: DISE ë¹„ë””ì˜¤ (.mp4)
  â†“
ì¶œë ¥: 
  - ì˜ì—­ë³„ êµ¬ê°„ (ëª‡ ì´ˆ~ëª‡ ì´ˆ: OTE, ëª‡ ì´ˆ~ëª‡ ì´ˆ: Velum)
  - íìƒ‰ ì´ë²¤íŠ¸ (ëª‡ ì´ˆ~ëª‡ ì´ˆ: 60% íìƒ‰, Severe)
  - ìœ„í—˜ êµ¬ê°„ ë¹„ë””ì˜¤ í´ë¦½
  - HTML ë¶„ì„ ë³´ê³ ì„œ
```

---

## ğŸ—ï¸ í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜

### ì „ì²´ íŒŒì´í”„ë¼ì¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. ë°ì´í„° ìˆ˜ì§‘                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ ì›ë³¸ ë°ì´í„°: AIHub DISE ë°ì´í„°ì…‹                        â”‚
â”‚  â€¢ ì•½ 1,525ê°œ Velum ë¹„ë””ì˜¤                               â”‚
â”‚  â€¢ ê° ë¹„ë””ì˜¤: 16~26ì´ˆ, 30fps                             â”‚
â”‚  â€¢ êµ¬ì¡°: dataset/Velum/*.mp4, dataset/OTE/*.mp4         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            2. ë°ì´í„° ì „ì²˜ë¦¬ (Classificationìš©)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [2-1] í”„ë ˆì„ ì¶”ì¶œ                                        â”‚
â”‚    â€¢ ë¹„ë””ì˜¤ â†’ ì´ë¯¸ì§€ í”„ë ˆì„ ë³€í™˜                           â”‚
â”‚    â€¢ ì• 2ì´ˆ, ë’¤ 3ì´ˆ ì œì™¸ (ì‚½ì…/ì œê±° ë…¸ì´ì¦ˆ)                 â”‚
â”‚    â€¢ FPS ì¡°ì • (30fps â†’ 5fps ì¶”ì¶œ)                        â”‚
â”‚                                                          â”‚
â”‚  [2-2] ROI ê²€ì¶œ (video_analyzer.py)                      â”‚
â”‚    â€¢ HSV ìƒ‰ê³µê°„ ë³€í™˜                                      â”‚
â”‚    â€¢ ì–´ë‘ìš´ ì˜ì—­(V<80) íƒ€ê²ŸíŒ…                             â”‚
â”‚    â€¢ ê°€ì¥ í° ì—°ê²° ì˜ì—­ = ROI                              â”‚
â”‚    â€¢ ROI ë©´ì  ê³„ì‚°                                        â”‚
â”‚                                                          â”‚
â”‚  [2-3] ìë™ ë¼ë²¨ë§                                        â”‚
â”‚    â€¢ OTE/Velum: ROI ìˆê³  í’ˆì§ˆ ì–‘í˜¸í•œ í”„ë ˆì„               â”‚
â”‚    â€¢ None: ROI ì—†ê±°ë‚˜ ë°ê±°ë‚˜ íë¦° í”„ë ˆì„                   â”‚
â”‚                                                          â”‚
â”‚  ì¶œë ¥: processed_dataset/                                â”‚
â”‚    â”œâ”€â”€ OTE/      (í”„ë ˆì„ ì´ë¯¸ì§€ë“¤)                        â”‚
â”‚    â”œâ”€â”€ Velum/    (í”„ë ˆì„ ì´ë¯¸ì§€ë“¤)                        â”‚
â”‚    â”œâ”€â”€ None/     (í”„ë ˆì„ ì´ë¯¸ì§€ë“¤)                        â”‚
â”‚    â””â”€â”€ annotations.json                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              3. Classification ëª¨ë¸ í•™ìŠµ                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [3-1] ë°ì´í„°ì…‹ êµ¬ì„±                                      â”‚
â”‚    â€¢ Train: 80%                                          â”‚
â”‚    â€¢ Validation: 10%                                     â”‚
â”‚    â€¢ Test: 10%                                           â”‚
â”‚    â€¢ ëª©í‘œ: ê° í´ë˜ìŠ¤ 20,000ì¥                             â”‚
â”‚                                                          â”‚
â”‚  [3-2] ëª¨ë¸ ì•„í‚¤í…ì²˜                                      â”‚
â”‚    â€¢ ResNet-50 (pretrained on ImageNet)                 â”‚
â”‚    â€¢ 3-class classification (OTE/Velum/None)            â”‚
â”‚    â€¢ Input: 224x224 RGB ì´ë¯¸ì§€                           â”‚
â”‚                                                          â”‚
â”‚  [3-3] í•™ìŠµ ì„¤ì •                                          â”‚
â”‚    â€¢ Optimizer: Adam (lr=1e-4)                          â”‚
â”‚    â€¢ Loss: CrossEntropyLoss                             â”‚
â”‚    â€¢ Epochs: 50                                          â”‚
â”‚    â€¢ Batch size: 32                                      â”‚
â”‚    â€¢ Data augmentation: RandomFlip, ColorJitter         â”‚
â”‚                                                          â”‚
â”‚  ì¶œë ¥: checkpoints/best_model.pth                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                4. í†µí•© ë¶„ì„ (Inference)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [4-1] í”„ë ˆì„ë³„ ë¶„ë¥˜                                      â”‚
â”‚    â€¢ ë¹„ë””ì˜¤ â†’ í”„ë ˆì„ ì¶”ì¶œ                                 â”‚
â”‚    â€¢ Classification ëª¨ë¸ë¡œ ì˜ˆì¸¡                           â”‚
â”‚    â€¢ ê° í”„ë ˆì„: OTE/Velum/None + confidence              â”‚
â”‚                                                          â”‚
â”‚  [4-2] ì—°ì† êµ¬ê°„ ê°ì§€                                     â”‚
â”‚    â€¢ ê°™ì€ ë¼ë²¨ì˜ ì—°ì† í”„ë ˆì„ ê·¸ë£¹í™”                         â”‚
â”‚    â€¢ ì˜ˆ: frame 120~450 â†’ Velum (4.0s~15.0s)            â”‚
â”‚                                                          â”‚
â”‚  [4-3] OTE/Velum êµ¬ê°„ì—ì„œë§Œ ROI ë¶„ì„                      â”‚
â”‚    â€¢ video_analyzerë¡œ ROI ë©´ì  ì¸¡ì •                       â”‚
â”‚    â€¢ êµ¬ê°„ë³„ ìµœëŒ€ ROI ë©´ì  ê³„ì‚°                            â”‚
â”‚    â€¢ ê¸°ì¤€: max_roi_area                                  â”‚
â”‚                                                          â”‚
â”‚  [4-4] íìƒ‰ ì´ë²¤íŠ¸ ê°ì§€                                   â”‚
â”‚    â€¢ ROI ë©´ì ì´ ê¸°ì¤€ ëŒ€ë¹„ 30% ì´ìƒ ê°ì†Œ ì‹œ                 â”‚
â”‚    â€¢ ì—°ì† í”„ë ˆì„ â†’ ì´ë²¤íŠ¸ êµ¬ê°„                            â”‚
â”‚    â€¢ ì˜ˆ: 7.2s~9.5s, 65% ê°ì†Œ, Severe                    â”‚
â”‚                                                          â”‚
â”‚  [4-5] ë¹„ë””ì˜¤ í´ë¦½ ìƒì„±                                   â”‚
â”‚    â€¢ ê° ì´ë²¤íŠ¸ë§ˆë‹¤ mp4 í´ë¦½ ìƒì„±                          â”‚
â”‚    â€¢ ì „í›„ 0.5ì´ˆ ì—¬ìœ  í¬í•¨                                 â”‚
â”‚    â€¢ ë¹¨ê°„ í…Œë‘ë¦¬ + í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´                         â”‚
â”‚                                                          â”‚
â”‚  ì¶œë ¥: analysis_results.json + event_clips/*.mp4         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  5. ë³´ê³ ì„œ ìƒì„± & ì›¹ í‘œì‹œ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [5-1] HTML ë³´ê³ ì„œ ìƒì„±                                   â”‚
â”‚    â€¢ íƒ€ì„ë¼ì¸ ì°¨íŠ¸ (êµ¬ê°„ë³„ ìƒ‰ìƒ)                           â”‚
â”‚    â€¢ ì‹¬ê°ë„ ì°¨íŠ¸ (ë§‰ëŒ€ + íŒŒì´)                            â”‚
â”‚    â€¢ ì´ë²¤íŠ¸ ì¹´ë“œ (ìƒì„¸ ì •ë³´)                              â”‚
â”‚    â€¢ ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ (í´ë¦½ ì¬ìƒ)                           â”‚
â”‚                                                          â”‚
â”‚  [5-2] Flask ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜                              â”‚
â”‚    â€¢ ë¹„ë””ì˜¤ ì—…ë¡œë“œ â†’ ë¶„ì„ â†’ ê²°ê³¼ í‘œì‹œ                     â”‚
â”‚    â€¢ ì¸í„°ë™í‹°ë¸Œ ë³´ê³ ì„œ                                    â”‚
â”‚    â€¢ ì´ë²¤íŠ¸ í´ë¦½ ìŠ¤íŠ¸ë¦¬ë°                                 â”‚
â”‚                                                          â”‚
â”‚  ì¶œë ¥: report.html + ì›¹ ì¸í„°í˜ì´ìŠ¤                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ í´ë” êµ¬ì¡°

```
real_dise_cy/
â”‚
â”œâ”€â”€ dataset/                              # ì›ë³¸ ë¹„ë””ì˜¤
â”‚   â”œâ”€â”€ OTE/
â”‚   â”‚   â””â”€â”€ *.mp4                        # OTE ì˜ì—­ ë¹„ë””ì˜¤ë“¤
â”‚   â””â”€â”€ Velum/
â”‚       â””â”€â”€ *.mp4                        # Velum ì˜ì—­ ë¹„ë””ì˜¤ë“¤ (1,525ê°œ)
â”‚
â”œâ”€â”€ ote_velum_classification_final/       # Classification í”„ë¡œì íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ dataset.py                        # PyTorch Dataset
â”‚   â”œâ”€â”€ model.py                          # ëª¨ë¸ ì •ì˜ (ResNet, EfficientNet)
â”‚   â”œâ”€â”€ train.py                          # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ inference.py                      # ì¶”ë¡  ìŠ¤í¬ë¦½íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ preprocess_with_analyzer.py       # â­ ì „ì²˜ë¦¬ (analyzer í™œìš©)
â”‚   â”œâ”€â”€ preprocess_videos_robust.py       # 6ì§€í‘œ ë¶„ì„
â”‚   â”œâ”€â”€ preprocess_videos_smart.py        # ìë™ ê²€ì‚¬ êµ¬ê°„ ê°ì§€
â”‚   â”‚
â”‚   â”œâ”€â”€ processed_dataset/                # ì „ì²˜ë¦¬ í›„ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ OTE/
â”‚   â”‚   â”œâ”€â”€ Velum/
â”‚   â”‚   â”œâ”€â”€ None/
â”‚   â”‚   â”œâ”€â”€ annotations.json
â”‚   â”‚   â””â”€â”€ dataset_stats.json
â”‚   â”‚
â”‚   â”œâ”€â”€ checkpoints/                      # í•™ìŠµ í›„ ìƒì„±
â”‚   â”‚   â”œâ”€â”€ best_model.pth               # â­ í•™ìŠµëœ ëª¨ë¸
â”‚   â”‚   â”œâ”€â”€ training_history.png
â”‚   â”‚   â””â”€â”€ confusion_matrix.png
â”‚   â”‚
â”‚   â””â”€â”€ [ê°€ì´ë“œ ë¬¸ì„œë“¤]
â”‚       â”œâ”€â”€ COMPLETE_GUIDE.md
â”‚       â”œâ”€â”€ ANALYZER_GUIDE.md
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ video_analyzer.py                     # ROI ê²€ì¶œ & íìƒ‰ ë¶„ì„
â”œâ”€â”€ app.py                               # ê¸°ì¡´ Flask ì›¹ì•±
â”œâ”€â”€ report_generator.py                  # ê¸°ì¡´ ë³´ê³ ì„œ ìƒì„±
â”‚
â”œâ”€â”€ integrated_analyzer.py                # â­ í†µí•© ë¶„ì„ ì—”ì§„
â”œâ”€â”€ integrated_app.py                    # â­ í†µí•© ì›¹ì•±
â”œâ”€â”€ integrated_report_generator.py       # â­ í†µí•© ë³´ê³ ì„œ
â”‚
â””â”€â”€ uploads/                             # ì›¹ ì—…ë¡œë“œ íŒŒì¼
    â””â”€â”€ outputs/                         # ë¶„ì„ ê²°ê³¼
```

---

## ğŸ”¬ í•µì‹¬ ê¸°ìˆ  ì„¤ëª…

### 1. ROI ê²€ì¶œ (video_analyzer.py)

**ëª©ì **: ë‚´ì‹œê²½ ì˜ìƒì—ì„œ ê¸°ë„ ë‚´ë¶€ì˜ ì–´ë‘ìš´ ì˜ì—­(ROI) ì°¾ê¸°

**ë°©ë²•**:
```python
# HSV ìƒ‰ê³µê°„ ë³€í™˜
hsv = cv2.cvtColor(frame, cv2.COLOR_BGR2HSV)

# V(ë°ê¸°) ì±„ë„ì—ì„œ ì–´ë‘ìš´ ì˜ì—­ ì¶”ì¶œ
lower = [0, 0, 0]      # H, S, V ìµœì†Œ
upper = [180, 255, 80]  # H, S, V ìµœëŒ€ (V=80 â†’ ì–´ë‘ìš´ ê²ƒë§Œ)

mask = cv2.inRange(hsv, lower, upper)

# ê°€ì¥ í° ì—°ê²° ì˜ì—­ = ROI
roi_area = largest_connected_component(mask)
```

**ì™œ V < 80?**
- ê¸°ë„ ë‚´ë¶€ëŠ” ë¹›ì´ ì ì–´ ì–´ë‘¡ê²Œ ë³´ì„
- ì£¼ë³€ ì¡°ì§ì€ ë°ê²Œ ë³´ì„
- V=80 ì´í•˜ â†’ ê¸°ë„ ë‚´ë¶€ë§Œ ì„ íƒ

**ROI ë©´ì ì˜ ì˜ë¯¸**:
- í° ë©´ì  (500,000 pxÂ²) â†’ ê¸°ë„ê°€ ì—´ë ¤ìˆìŒ
- ì‘ì€ ë©´ì  (100,000 pxÂ²) â†’ ê¸°ë„ê°€ ì¢ì•„ì§ (íìƒ‰)

---

### 2. ìë™ ë¼ë²¨ë§ (preprocess_with_analyzer.py)

**ë¬¸ì œ**: None í´ë˜ìŠ¤ ë°ì´í„°ê°€ ì—†ìŒ

**í•´ê²°**: í’ˆì§ˆ ê¸°ë°˜ ìë™ ë¶„ë¥˜

```python
def classify_frame(frame, roi_area, video_type):
    """
    OTE/Velum ë¹„ë””ì˜¤ì˜ ê° í”„ë ˆì„ì„ ìë™ ë¶„ë¥˜
    """
    
    # 1. ROI ì—†ìŒ â†’ None
    if roi_area == 0:
        return 'None'
    
    # 2. ROI ë„ˆë¬´ ì‘ìŒ â†’ None
    if roi_area < 50000:  # ì•½ 224x224 í¬ê¸°
        return 'None'
    
    # 3. ë„ˆë¬´ ë°ìŒ (ê³¼ë‹¤ ë…¸ì¶œ) â†’ None
    brightness = mean(frame)
    if brightness > 160:
        return 'None'
    
    # 4. ë„ˆë¬´ ì–´ë‘ì›€ â†’ None
    if brightness < 40:
        return 'None'
    
    # âœ… ê·¸ ì™¸ â†’ video_type (OTE ë˜ëŠ” Velum)
    return video_type
```

**Noneì˜ ì˜ë¯¸**:
- ë‚´ì‹œê²½ ì‚½ì…/ì œê±° ì‹œ ë…¸ì´ì¦ˆ
- ì „í™˜ êµ¬ê°„ (OTEâ†”Velum)
- í’ˆì§ˆì´ ë‚˜ìœ í”„ë ˆì„
- **"OTEë„ Velumë„ ì•„ë‹Œ ëª¨ë“  ê²ƒ"**

---

### 3. Classification ëª¨ë¸

**ì•„í‚¤í…ì²˜**:
```
Input (224x224x3)
    â†“
ResNet-50 Backbone (pretrained)
    â†“
Global Average Pooling
    â†“
Fully Connected (2048 â†’ 3)
    â†“
Softmax
    â†“
Output: [P(OTE), P(Velum), P(None)]
```

**í•™ìŠµ ê³¼ì •**:
```python
for epoch in range(50):
    for batch in train_loader:
        images, labels = batch
        
        # Forward
        outputs = model(images)
        loss = criterion(outputs, labels)
        
        # Backward
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
    
    # Validation
    val_acc = evaluate(model, val_loader)
    if val_acc > best_acc:
        save_model('best_model.pth')
```

**í‰ê°€ ì§€í‘œ**:
- Overall Accuracy: ì „ì²´ ì •í™•ë„
- Precision/Recall/F1: í´ë˜ìŠ¤ë³„ ì„±ëŠ¥
- Confusion Matrix: ì˜¤ë¶„ë¥˜ íŒ¨í„´

---

### 4. ì—°ì† êµ¬ê°„ ê°ì§€ (integrated_analyzer.py)

**ëª©ì **: í”„ë ˆì„ë³„ ì˜ˆì¸¡ â†’ ì‹œê°„ êµ¬ê°„ìœ¼ë¡œ ë³€í™˜

**ì•Œê³ ë¦¬ì¦˜**:
```python
segments = []
current_segment = None

for frame in video:
    label = classify(frame)
    
    if label in ['OTE', 'Velum']:
        if current_segment is None:
            # ìƒˆ êµ¬ê°„ ì‹œì‘
            current_segment = {
                'label': label,
                'start_time': frame.timestamp,
                'frames': [frame]
            }
        elif current_segment['label'] == label:
            # ê°™ì€ êµ¬ê°„ ê³„ì†
            current_segment['frames'].append(frame)
        else:
            # êµ¬ê°„ ë³€ê²½ â†’ ì´ì „ êµ¬ê°„ ì €ì¥
            segments.append(current_segment)
            current_segment = new_segment(label, frame)
    else:
        # None â†’ êµ¬ê°„ ì¢…ë£Œ
        if current_segment:
            segments.append(current_segment)
            current_segment = None
```

**ê²°ê³¼**:
```python
segments = [
    {
        'label': 'Velum',
        'start_time': 2.0,
        'end_time': 8.5,
        'duration': 6.5,
        'frames': [...]
    },
    {
        'label': 'OTE',
        'start_time': 10.0,
        'end_time': 15.3,
        'duration': 5.3,
        'frames': [...]
    }
]
```

---

### 5. íìƒ‰ ì´ë²¤íŠ¸ ê°ì§€

**ê°œë…**:
```
ì •ìƒ ìƒíƒœ: ROI ë©´ì  = 500,000 pxÂ²
    â†“
íìƒ‰ ë°œìƒ: ROI ë©´ì  = 150,000 pxÂ² (70% ê°ì†Œ!)
    â†“
ê°ì§€: "Critical íìƒ‰ ì´ë²¤íŠ¸"
```

**ì•Œê³ ë¦¬ì¦˜**:
```python
for segment in segments:  # OTE/Velum êµ¬ê°„ë§Œ
    # í•´ë‹¹ êµ¬ê°„ì˜ ìµœëŒ€ ROI
    max_area = max(f.roi_area for f in segment.frames)
    threshold = max_area * 0.7  # 30% ê°ì†Œ ê¸°ì¤€
    
    current_event = None
    
    for frame in segment.frames:
        if frame.roi_area < threshold:
            # íìƒ‰ ìƒíƒœ
            reduction = (1 - frame.roi_area/max_area) * 100
            
            if current_event is None:
                current_event = start_event(frame, reduction)
            else:
                current_event.update(frame, reduction)
        else:
            # íìƒ‰ í•´ì œ
            if current_event:
                if current_event.duration >= 1.0:  # ìµœì†Œ 1ì´ˆ
                    events.append(current_event)
                current_event = None
```

**ì‹¬ê°ë„ ë¶„ë¥˜**:
```python
def classify_severity(reduction_percent):
    if reduction >= 70: return 'Critical'  # 70%+
    if reduction >= 50: return 'Severe'    # 50-70%
    if reduction >= 30: return 'Moderate'  # 30-50%
    return 'Mild'                          # <30%
```

---

### 6. ë¹„ë””ì˜¤ í´ë¦½ ìƒì„±

**ëª©ì **: ìœ„í—˜ êµ¬ê°„ë§Œ ë³„ë„ ì˜ìƒìœ¼ë¡œ ì €ì¥

**êµ¬í˜„**:
```python
for event in events:
    # í´ë¦½ ë²”ìœ„ (ì „í›„ 0.5ì´ˆ ì—¬ìœ )
    start_frame = event.start_frame - int(fps * 0.5)
    end_frame = event.end_frame + int(fps * 0.5)
    
    # VideoWriter ìƒì„±
    clip_path = f"event_{i}_{event.label}_{event.severity}.mp4"
    writer = cv2.VideoWriter(clip_path, fourcc, fps, (w, h))
    
    # í”„ë ˆì„ ì¶”ì¶œ ë° í‘œì‹œ
    for frame_num in range(start_frame, end_frame):
        frame = get_frame(video, frame_num)
        
        # ìœ„í—˜ êµ¬ê°„ ê°•ì¡°
        if event.start_frame <= frame_num <= event.end_frame:
            cv2.rectangle(frame, (10,10), (w-10,h-10), (0,0,255), 5)
            cv2.putText(frame, f"{event.severity} - {event.label}", 
                       (20, 50), font, 1.5, (0,0,255), 3)
        
        writer.write(frame)
    
    writer.release()
```

---

## ğŸ“Š ë°ì´í„° í”Œë¡œìš°

### ì „ì²´ ë°ì´í„° íë¦„

```
ì›ë³¸ ë¹„ë””ì˜¤ (1,525ê°œ Velum)
    â†“
í”„ë ˆì„ ì¶”ì¶œ (30fps â†’ 5fps)
    â†“
ì•½ 150,000 í”„ë ˆì„
    â†“
ìë™ ë¼ë²¨ë§
    â”œâ”€ OTE: 0ê°œ (Velum ë¹„ë””ì˜¤ë§Œ ìˆì–´ì„œ)
    â”œâ”€ Velum: 60,000ê°œ
    â””â”€ None: 90,000ê°œ
    â†“
ë°ì´í„° ì¦ê°• + ê· í˜• ì¡°ì •
    â”œâ”€ OTE: 20,000ê°œ (ì¶”ê°€ ìˆ˜ì§‘ í•„ìš”)
    â”œâ”€ Velum: 20,000ê°œ (ìƒ˜í”Œë§)
    â””â”€ None: 20,000ê°œ (ìƒ˜í”Œë§)
    â†“
Train/Val/Test ë¶„í• 
    â”œâ”€ Train: 48,000 (80%)
    â”œâ”€ Val: 6,000 (10%)
    â””â”€ Test: 6,000 (10%)
    â†“
ëª¨ë¸ í•™ìŠµ
    â†“
best_model.pth (94% accuracy)
    â†“
ì‹¤ì œ ë¹„ë””ì˜¤ ë¶„ì„
    â†“
êµ¬ê°„ + ì´ë²¤íŠ¸ + í´ë¦½ + ë³´ê³ ì„œ
```

---

## ğŸ¯ í˜„ì¬ ìƒíƒœ & ë‹¤ìŒ ë‹¨ê³„

### âœ… ì™„ë£Œëœ ê²ƒ

1. **ë°ì´í„° ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸**
   - âœ… video_analyzer.py ê¸°ë°˜ ROI ê²€ì¶œ
   - âœ… ìë™ ë¼ë²¨ë§ (OTE/Velum/None)
   - âœ… í’ˆì§ˆ ë¶„ì„ (6ê°€ì§€ ì§€í‘œ)
   - âœ… ì‹œê°í™” (ê·¸ë˜í”„ ìƒì„±)

2. **ëª¨ë¸ í•™ìŠµ ì½”ë“œ**
   - âœ… dataset.py (PyTorch Dataset)
   - âœ… model.py (ResNet, EfficientNet)
   - âœ… train.py (í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸)
   - âœ… inference.py (ì¶”ë¡ )

3. **í†µí•© ë¶„ì„ ì‹œìŠ¤í…œ**
   - âœ… integrated_analyzer.py (ì „ì²´ íŒŒì´í”„ë¼ì¸)
   - âœ… ì—°ì† êµ¬ê°„ ê°ì§€
   - âœ… íìƒ‰ ì´ë²¤íŠ¸ ê°ì§€
   - âœ… ë¹„ë””ì˜¤ í´ë¦½ ìƒì„±

4. **ì›¹ ì¸í„°í˜ì´ìŠ¤**
   - âœ… integrated_app.py (Flask)
   - âœ… integrated_report_generator.py
   - âœ… HTML ë³´ê³ ì„œ

### â³ ì§„í–‰ ì¤‘

1. **Classification ëª¨ë¸ í•™ìŠµ**
   - ì „ì²˜ë¦¬ ì™„ë£Œ
   - ëª¨ë¸ í•™ìŠµ ì¤‘
   - ë°ì´í„°: ê° í´ë˜ìŠ¤ 20,000ì¥ ëª©í‘œ

### ğŸ”œ ë‹¤ìŒ í•´ì•¼ í•  ê²ƒ

1. **ëª¨ë¸ í•™ìŠµ ì™„ë£Œ & í‰ê°€**
   ```bash
   cd ote_velum_classification_final
   python train.py
   # â†’ checkpoints/best_model.pth ìƒì„±
   ```

2. **ì „ì²´ íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸**
   ```bash
   cd ..  # real_dise_cyë¡œ
   python integrated_analyzer.py
   # â†’ ì‹¤ì œ ë¹„ë””ì˜¤ë¡œ í…ŒìŠ¤íŠ¸
   ```

3. **ì›¹ ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸**
   ```bash
   python integrated_app.py
   # â†’ http://localhost:5000
   # â†’ ë¹„ë””ì˜¤ ì—…ë¡œë“œ & ê²°ê³¼ í™•ì¸
   ```

4. **ì„±ëŠ¥ í‰ê°€ & ê°œì„ **
   - Confusion matrix ë¶„ì„
   - ì˜¤ë¶„ë¥˜ íŒ¨í„´ íŒŒì•…
   - í•„ìš”ì‹œ ë°ì´í„° ì¶”ê°€ ìˆ˜ì§‘

5. **ë³´ê³ ì„œ ì‘ì„±**
   - í”„ë¡œì íŠ¸ ë¬¸ì„œí™”
   - ë°œí‘œ ìë£Œ ì¤€ë¹„
   - ë…¼ë¬¸/íŠ¹í—ˆ ì‘ì„±

---

## ğŸš§ í˜„ì¬ ë¬¸ì œì  & í•´ê²° ë°©ë²•

### ë¬¸ì œ 1: Velum ë¹„ë””ì˜¤ì—ì„œ Noneë§Œ ê²€ì¶œë¨

**ì›ì¸**:
```python
# classify_frame ì„ê³„ê°’ì´ ë„ˆë¬´ ì—„ê²©
if quality_score < 0.4:      # â† ë„ˆë¬´ ë‚®ìŒ
if area_ratio < 0.3:         # â† ë„ˆë¬´ ì—„ê²©
if mean_brightness > 200:    # â† ë„ˆë¬´ ë‚®ìŒ
```

**í•´ê²°**:
```python
# ì™„í™”ëœ ê¸°ì¤€
if roi_area < 50000:         # ROI ì ˆëŒ€ê°’ ê¸°ì¤€
if mean_brightness > 160:    # ë°ê¸° ì™„í™”
if mean_brightness < 40:     # ì–´ë‘ì›€ ì™„í™”
```

**ìƒíƒœ**: ì½”ë“œ ìˆ˜ì • ì™„ë£Œ, ì¬ì‹¤í–‰ í•„ìš”

---

### ë¬¸ì œ 2: OTE ë°ì´í„° ë¶€ì¡±

**í˜„í™©**: 
- Velum ë¹„ë””ì˜¤: 1,525ê°œ âœ…
- OTE ë¹„ë””ì˜¤: ë¶€ì¡± âŒ

**í•´ê²° ë°©ë²•**:
1. ì¶”ê°€ OTE ë¹„ë””ì˜¤ ìˆ˜ì§‘
2. Data augmentation ê°•í™”
3. Transfer learning í™œìš©

---

### ë¬¸ì œ 3: ê²½ë¡œ ë¬¸ì œ (PowerShell)

**ë¬¸ì œ**: 
```powershell
D:/chaeyeon/ëŒ€í•™ì›/3í•™ê¸°/ìœµí”„/data/DISE_DATA(AIHub)/little/
# â† ê´„í˜¸ ë•Œë¬¸ì— ì—ëŸ¬
```

**í•´ê²°**:
```powershell
# ë”°ì˜´í‘œë¡œ ê°ì‹¸ê¸°
python preprocess_with_analyzer.py --dataset "D:/chaeyeon/ëŒ€í•™ì›/3í•™ê¸°/ìœµí”„/data/DISE_DATA(AIHub)/little/"
```

---

## ğŸ“ í•µì‹¬ ê°œë… ì •ë¦¬

### 1. OTE vs Velum

**OTE (Oropharynx, Tongue base, Epiglottis)**:
- êµ¬ê°•ì¸ë‘, í˜€ ê¸°ì €ë¶€, í›„ë‘ê°œ
- í•˜ë¶€ ê¸°ë„
- í˜€ê°€ ë’¤ë¡œ ë°€ë ¤ íìƒ‰ ë°œìƒ

**Velum**:
- ì—°êµ¬ê°œ (soft palate)
- ìƒë¶€ ê¸°ë„
- ëª©ì – ì£¼ë³€ì´ ì³ì ¸ì„œ íìƒ‰ ë°œìƒ

### 2. Noneì˜ ì •ì˜

```
None = "OTEë„ Velumë„ ì•„ë‹Œ ëª¨ë“  ê²ƒ"
â”œâ”€ ë‚´ì‹œê²½ ì‚½ì… ì‹œ ë…¸ì´ì¦ˆ
â”œâ”€ ë‚´ì‹œê²½ ì œê±° ì‹œ ë…¸ì´ì¦ˆ
â”œâ”€ OTE â†” Velum ì „í™˜ êµ¬ê°„
â”œâ”€ ê³¼ë‹¤ ë…¸ì¶œ í”„ë ˆì„
â”œâ”€ íë¦¿í•œ í”„ë ˆì„
â””â”€ ROI ì—†ëŠ” í”„ë ˆì„
```

### 3. ROI (Region of Interest)

```
ROI = ê¸°ë„ ë‚´ë¶€ì˜ ì–´ë‘ìš´ ì˜ì—­
    = HSVì—ì„œ V < 80ì¸ ì˜ì—­
    = ê°€ì¥ í° ì—°ê²° ì˜ì—­
```

**ROI ë©´ì  ë³€í™”**:
```
ì •ìƒ:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  500,000 pxÂ²
ê²½ì¦:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      400,000 pxÂ² (20% ê°ì†Œ)
ì¤‘ë“±ì¦:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         250,000 pxÂ² (50% ê°ì†Œ)
ì¤‘ì¦:    â–ˆâ–ˆ            100,000 pxÂ² (80% ê°ì†Œ)
```

### 4. íìƒ‰ (Obstruction)

**ì •ì˜**: ROI ë©´ì ì´ ê¸°ì¤€ ëŒ€ë¹„ 30% ì´ìƒ ê°ì†Œ

**ì¸¡ì •**:
```python
reduction = (1 - current_area / max_area) Ã— 100%
```

**ì‹¬ê°ë„**:
- Mild: 30-50%
- Moderate: 50-70%
- Severe: 70-80%
- Critical: 80%+

---

## ğŸ“ ë°œí‘œ ì¤€ë¹„

### Weekly Progress 9 í•µì‹¬ ë‚´ìš©

1. **ë°ì´í„° ì „ì²˜ë¦¬ ì™„ë£Œ**
   - None ë¼ë²¨ ìë™ ì¶”ì¶œ ì „ëµ êµ¬í˜„
   - ê° í´ë˜ìŠ¤ 20,000ì¥ ìˆ˜ì§‘

2. **Classification ëª¨ë¸ í•™ìŠµ ì¤‘**
   - ResNet-50 ê¸°ë°˜
   - 3-class (OTE/Velum/None)

3. **í†µí•© íŒŒì´í”„ë¼ì¸ ì„¤ê³„**
   - í”„ë ˆì„ ë¶„ë¥˜ â†’ êµ¬ê°„ ê°ì§€ â†’ íìƒ‰ ë¶„ì„
   - ì—°ì†ì„± ìˆëŠ” ì´ë²¤íŠ¸ ê¸°ë¡

4. **ë‹¤ìŒ ë‹¨ê³„**
   - ëª¨ë¸ í•™ìŠµ ì™„ë£Œ
   - ì „ì²´ íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸
   - ìƒ˜í”Œ ê²°ê³¼ ì¤€ë¹„

---

## ğŸ”— íŒŒì¼ ê°„ ê´€ê³„ë„

```
video_analyzer.py
    â†“ (ROI ê²€ì¶œ)
preprocess_with_analyzer.py
    â†“ (í”„ë ˆì„ ì €ì¥)
processed_dataset/
    â†“ (í•™ìŠµ ë°ì´í„°)
train.py
    â†“ (ëª¨ë¸ ìƒì„±)
checkpoints/best_model.pth
    â†“ (ì‚¬ìš©)
integrated_analyzer.py
    â”œâ”€ (ë¶„ë¥˜) â†’ Classification ëª¨ë¸
    â”œâ”€ (ë¶„ì„) â†’ video_analyzer.py
    â””â”€ (ë³´ê³ ì„œ) â†’ integrated_report_generator.py
        â†“
report.html + ë¹„ë””ì˜¤ í´ë¦½
```

---

## ğŸ’» ì „ì²´ ì‹¤í–‰ ìˆœì„œ

```bash
# 1ë‹¨ê³„: í™˜ê²½ ì„¤ì •
cd real_dise_cy/ote_velum_classification_final
pip install -r requirements.txt

# 2ë‹¨ê³„: ì „ì²˜ë¦¬
python preprocess_with_analyzer.py --dataset ../dataset --output processed_dataset

# 3ë‹¨ê³„: ê²°ê³¼ í™•ì¸
ls processed_dataset/OTE/
ls processed_dataset/Velum/
ls processed_dataset/None/

# 4ë‹¨ê³„: í•™ìŠµ
python train.py

# 5ë‹¨ê³„: í†µí•© ë¶„ì„ í…ŒìŠ¤íŠ¸
cd ..
python integrated_analyzer.py

# 6ë‹¨ê³„: ì›¹ ì¸í„°í˜ì´ìŠ¤
python integrated_app.py
# â†’ http://localhost:5000
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

### í”„ë¡œì íŠ¸ ë¬¸ì„œ
- `COMPLETE_GUIDE.md`: ì „ì²´ ì‚¬ìš© ê°€ì´ë“œ
- `ANALYZER_GUIDE.md`: video_analyzer.py í™œìš©
- `INTEGRATED_GUIDE.md`: í†µí•© ì‹œìŠ¤í…œ ê°€ì´ë“œ
- `PROJECT_STRUCTURE.txt`: íŒŒì¼ êµ¬ì¡°

### ì½”ë“œ ìœ„ì¹˜
- Classification: `ote_velum_classification_final/`
- í†µí•© ë¶„ì„: `integrated_*.py`
- ì›¹ ì¸í„°í˜ì´ìŠ¤: `integrated_app.py`

---

ì´ê²ƒì´ ë‹¹ì‹ ì˜ í”„ë¡œì íŠ¸ ì „ì²´ ë‚´ìš©ì…ë‹ˆë‹¤! Aë¶€í„° Zê¹Œì§€ ì™„ë²½í•˜ê²Œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. ğŸ‰

í˜„ì¬ëŠ” Classification ëª¨ë¸ í•™ìŠµ ë‹¨ê³„ì´ê³ , í•™ìŠµ ì™„ë£Œ í›„ ì „ì²´ íŒŒì´í”„ë¼ì¸ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤!